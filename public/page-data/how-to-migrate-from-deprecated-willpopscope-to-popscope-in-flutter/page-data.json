{"componentChunkName":"component---src-templates-blog-post-js","path":"/how-to-migrate-from-deprecated-willpopscope-to-popscope-in-flutter/","result":{"data":{"wpPost":{"id":"cG9zdDoxNzcxOA==","title":"How to migrate from deprecated WillpopScope to popScope in Flutter","excerpt":"","content":"<div class=\"fusion-fullwidth fullwidth-box fusion-builder-row-5 fusion-flex-container has-pattern-background has-mask-background nonhundred-percent-fullwidth non-hundred-percent-height-scrolling\" style=\"--awb-border-radius-top-left:0px;--awb-border-radius-top-right:0px;--awb-border-radius-bottom-right:0px;--awb-border-radius-bottom-left:0px;--awb-flex-wrap:wrap;\" ><div class=\"fusion-builder-row fusion-row fusion-flex-align-items-flex-start fusion-flex-content-wrap\" style=\"max-width:1310.4px;margin-left: calc(-4% / 2 );margin-right: calc(-4% / 2 );\"><div class=\"fusion-layout-column fusion_builder_column fusion-builder-column-26 fusion_builder_column_1_1 1_1 fusion-flex-column\" style=\"--awb-bg-size:cover;--awb-width-large:100%;--awb-margin-top-large:70px;--awb-spacing-right-large:1.92%;--awb-margin-bottom-large:20px;--awb-spacing-left-large:1.92%;--awb-width-medium:100%;--awb-order-medium:0;--awb-spacing-right-medium:1.92%;--awb-spacing-left-medium:1.92%;--awb-width-small:100%;--awb-order-small:0;--awb-spacing-right-small:1.92%;--awb-spacing-left-small:1.92%;\" data-scroll-devices=\"small-visibility,medium-visibility,large-visibility\"><div class=\"fusion-column-wrapper fusion-column-has-shadow fusion-flex-justify-content-flex-start fusion-content-layout-column\"><div class=\"fusion-text fusion-text-32\" style=\"--awb-font-size:38px;--awb-text-transform:capitalize;\"><h1>How To migrate from deprecated WillpopScope to popScope in Flutter</h1>\n</div><nav class=\"fusion-breadcrumbs awb-yoast-breadcrumbs fusion-breadcrumbs-4\" style=\"--awb-margin-top:-20px;--awb-font-size:16px;--awb-text-color:#000000;--awb-breadcrumb-sep:&#039;/&#039;;\" aria-label=\"Breadcrumb\"><span><span><a href=\"https://determinate-arrant-florencio.ngrok-free.dev/backup151025/\">Home</a></span> » <span><a href=\"https://determinate-arrant-florencio.ngrok-free.dev/backup151025/blog/\">Blog</a></span> » <span class=\"breadcrumb_last\" aria-current=\"page\">Integration of Ably for Real-Time Game Events in Factile and Its Advantages Over PubNub</span></span></nav><div class=\"fusion-image-element \" style=\"--awb-margin-top:10px;--awb-caption-title-font-family:var(--h2_typography-font-family);--awb-caption-title-font-weight:var(--h2_typography-font-weight);--awb-caption-title-font-style:var(--h2_typography-font-style);--awb-caption-title-size:var(--h2_typography-font-size);--awb-caption-title-transform:var(--h2_typography-text-transform);--awb-caption-title-line-height:var(--h2_typography-line-height);--awb-caption-title-letter-spacing:var(--h2_typography-letter-spacing);\"><span class=\" fusion-imageframe imageframe-none imageframe-13 hover-type-none\"><img decoding=\"async\" width=\"1200\" height=\"600\" title=\"C\" src=\"https://determinate-arrant-florencio.ngrok-free.dev/backup151025/wp-content/uploads/2024/06/C.webp\" data-orig-src=\"https://www.deligence.com/wp-content/uploads/2024/06/C.webp\" alt class=\"lazyload img-responsive wp-image-18653\" srcset=\"data:image/svg+xml,%3Csvg%20xmlns%3D%27http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%27%20width%3D%271200%27%20height%3D%27600%27%20viewBox%3D%270%200%201200%20600%27%3E%3Crect%20width%3D%271200%27%20height%3D%27600%27%20fill-opacity%3D%220%22%2F%3E%3C%2Fsvg%3E\" data-srcset=\"https://determinate-arrant-florencio.ngrok-free.dev/backup151025/wp-content/uploads/2024/06/C-200x100.webp 200w, https://determinate-arrant-florencio.ngrok-free.dev/backup151025/wp-content/uploads/2024/06/C-300x150.webp 300w, https://determinate-arrant-florencio.ngrok-free.dev/backup151025/wp-content/uploads/2024/06/C-400x200.webp 400w, https://determinate-arrant-florencio.ngrok-free.dev/backup151025/wp-content/uploads/2024/06/C-600x300.webp 600w, https://determinate-arrant-florencio.ngrok-free.dev/backup151025/wp-content/uploads/2024/06/C-768x384.webp 768w, https://determinate-arrant-florencio.ngrok-free.dev/backup151025/wp-content/uploads/2024/06/C-800x400.webp 800w, https://determinate-arrant-florencio.ngrok-free.dev/backup151025/wp-content/uploads/2024/06/C-1024x512.webp 1024w, https://determinate-arrant-florencio.ngrok-free.dev/backup151025/wp-content/uploads/2024/06/C.webp 1200w\" data-sizes=\"auto\" data-orig-sizes=\"(max-width: 1024px) 100vw, (max-width: 640px) 100vw, 1200px\" /></span></div></div></div><div class=\"fusion-layout-column fusion_builder_column fusion-builder-column-27 fusion_builder_column_1_1 1_1 fusion-flex-column\" style=\"--awb-bg-size:cover;--awb-width-large:100%;--awb-margin-top-large:0px;--awb-spacing-right-large:1.92%;--awb-margin-bottom-large:20px;--awb-spacing-left-large:1.92%;--awb-width-medium:100%;--awb-order-medium:0;--awb-spacing-right-medium:1.92%;--awb-spacing-left-medium:1.92%;--awb-width-small:100%;--awb-order-small:0;--awb-spacing-right-small:1.92%;--awb-spacing-left-small:1.92%;\"><div class=\"fusion-column-wrapper fusion-column-has-shadow fusion-flex-justify-content-flex-start fusion-content-layout-column\"><div class=\"fusion-text fusion-text-33\"><p><span style=\"font-weight: 400;\">Hello everyone! Today, we'll discuss how to remove the WillPopScope widget from your existing Flutter code, as it has been deprecated after version 3.12.0–1.0.pre-release.<br />\n</span></p>\n<p><span style=\"font-weight: 400;\">First, let's understand why we used the WillPopScope widget. This widget allowed us to control the device's back button gesture. Using WillPopScope, we could display dialogues, call APIs, or perform any necessary actions based on our business requirements. The widget takes two parameters:</span></p>\n<ul>\n<li><span style=\"font-weight: 400;\">onWillPop: This function is where we could show any DialogueBox or call any other functions.</span></li>\n<li><span style=\"font-weight: 400;\">Child: This is the widget for the view. Here, we add the widget we want to handle when the onWillPop function is called.</span></li>\n</ul>\n<p><span style=\"font-weight: 400;\">Now, we will show a real example using WillPopScope that is deprecated, and then we will provide migrated code using the PopScope widget. Before getting into the coding, let's discuss what PopScope is and why it is needed.</span></p>\n<p><span style=\"font-weight: 400;\">Android 14 introduced a new feature called Predictive Back Gesture. In short, the back gesture is now more unpredictable, and it happens immediately when the user interacts with the gesture. With predictive back, the back animation begins immediately when the user starts the gesture, and before it has been committed. There is no opportunity for the Flutter app to decide whether it's allowed to happen at that time. It must be known ahead of time.</span></p>\n<p><span style=\"font-weight: 400;\">For this reason, PopScope is introduced. To ensure safe routing, from Just In Time (WillPopScope) to Ahead Of Time (PopScope).</span></p>\n<p><span style=\"font-weight: 400;\">WillPopScope was asynchronous, it was only triggered when the user pressed the back gesture. While PopScope is synchronous, we must make it clear whether a route is possible, even before the user's attempt.</span></p>\n<p><span style=\"font-weight: 400;\">The PopScope widget has three parameters, and only the child is required:</span></p>\n<ul>\n<li><span style=\"font-weight: 400;\">canPop: This parameter can be used to disable system back gestures. It defaults to true, meaning that back gestures happen as usual.</span></li>\n<li><span style=\"font-weight: 400;\">onPopInvoked: This parameter detects system back gestures, regardless of their success. When canPop is false, the route won't be popped, but onPopInvoked will still be called with didPop set to false. If canPop is true, the route will be popped as usual, and onPopInvoked will report didPop as true, unless the pop fails for reasons unrelated to PopScope, in which case didPop will be false. This feature allows the handling of system back gestures within Flutter's navigation system.</span></li>\n<li><span style=\"font-weight: 400;\">child: This is a required parameter for building the Screen UI.</span></li>\n</ul>\n<p><span style=\"font-weight: 400;\">Now, let's start coding. Here, we have added a coding snippet with the deprecated WillPopScope widget:</span></p>\n</div><style type=\"text/css\" scopped=\"scopped\">.fusion-syntax-highlighter-9 > .CodeMirror, .fusion-syntax-highlighter-9 > .CodeMirror .CodeMirror-gutters {background-color:var(--awb-color1);}.fusion-syntax-highlighter-9 > .CodeMirror .CodeMirror-gutters { background-color: var(--awb-color2); }.fusion-syntax-highlighter-9 > .CodeMirror .CodeMirror-linenumber { color: var(--awb-color8); }</style><div class=\"fusion-syntax-highlighter-container fusion-syntax-highlighter-9 fusion-syntax-highlighter-theme-light\" style=\"opacity:0;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font-size:14px;border-width:1px;border-style:solid;border-color:var(--awb-color3);\"><div class=\"syntax-highlighter-copy-code\"><span class=\"syntax-highlighter-copy-code-title\" data-id=\"fusion_syntax_highlighter_9\" style=\"font-size:14px;\">Copy to Clipboard</span></div><label for=\"fusion_syntax_highlighter_9\" class=\"screen-reader-text\">Syntax Highlighter</label><textarea class=\"fusion-syntax-highlighter-textarea\" id=\"fusion_syntax_highlighter_9\" data-readOnly=\"nocursor\" data-lineNumbers=\"1\" data-lineWrapping=\"\" data-theme=\"default\" data-mode=\"text/x-sh\">class NextPage extends StatelessWidget {\n  Future<bool> _onWillPop(BuildContext context) async {\n    return await showDialog(\n          context: context,\n          barrierDismissible: false, // Prevent dismiss on tap outside\n          builder: (context) => AlertDialog(\n            title: Text(\"Exit\"),\n            content: Text(\"Do you want to exit?\"),\n            actions: <Widget>[\n              TextButton(\n                onPressed: () => Navigator.of(context)\n                    .pop(true), // Return true to pop the route\n                child: Text(\n                  \"Yes\",\n                  style: TextStyle(\n                    color: Colors.blue,\n                    fontSize: 18, \n       fontWeight: FontWeight.bold,\n                  ),\n                ),\n              ),\n              TextButton(\n                onPressed: () => Navigator.of(context)\n                    .pop(false), // Return false to stay on the route\n                child: Text(\n                  \"No\",\n                  style: TextStyle(\n                    color: Colors.blue, \n                    fontSize: 18,\n       fontWeight: FontWeight.bold,\n                 ),\n                ),\n              ),\n            ],\n          ),\n        ) ??\n        false; // Handle null case by returning false (stay on the route)\n  }\n\n\n  @override\n  Widget build(BuildContext context) {\n    return WillPopScope(\n      onWillPop: () => _onWillPop(context), // Call the _onWillPop function\n      child: Scaffold(\n        appBar: AppBar(\n          title: Text('Second Page'),\n        ),\n        body: Center(\n          child: ElevatedButton(\n            onPressed: () {\n              _onWillPop(context).then((exitConfirmed) {\n                if (exitConfirmed) {\n                  // Navigate back to the first page (HomePage) if exit is confirmed\n                  Navigator.pop(context);\n                }\n              });\n            },\n            child: Text('Back to First Page'),\n          ),  ),\n      ),   \n    );\n  }}</textarea></div><div class=\"fusion-text fusion-text-34 fusion-text-no-margin\" style=\"--awb-margin-top:30px;--awb-margin-bottom:20px;\"><p><span style=\"font-weight: 400;\">After updating Flutter, this code using </span><span style=\"font-weight: 400;\">WillPopScope</span><span style=\"font-weight: 400;\"> now shows a warning:</span><span style=\"font-weight: 400;\"><br />\n</span><b>'WillPopScope.new' is deprecated and shouldn't be used. Use PopScope instead. This feature was deprecated after v3.12.0-1.0.pre.</b></p>\n<p><span style=\"font-weight: 400;\">Finally, we will show how to migrate to</span> <b>PopScope</b> <span style=\"font-weight: 400;\">with an existing</span> <b>_onWillPop</b> <span style=\"font-weight: 400;\">function. We do not need to change our </span><span style=\"font-weight: 400;\">_onWillPop</span><span style=\"font-weight: 400;\"> function; we only have to replace some code:</span></p>\n</div><style type=\"text/css\" scopped=\"scopped\">.fusion-syntax-highlighter-10 > .CodeMirror, .fusion-syntax-highlighter-10 > .CodeMirror .CodeMirror-gutters {background-color:var(--awb-color1);}.fusion-syntax-highlighter-10 > .CodeMirror .CodeMirror-gutters { background-color: var(--awb-color2); }.fusion-syntax-highlighter-10 > .CodeMirror .CodeMirror-linenumber { color: var(--awb-color8); }</style><div class=\"fusion-syntax-highlighter-container fusion-syntax-highlighter-10 fusion-syntax-highlighter-theme-light\" style=\"opacity:0;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font-size:14px;border-width:1px;border-style:solid;border-color:var(--awb-color3);\"><div class=\"syntax-highlighter-copy-code\"><span class=\"syntax-highlighter-copy-code-title\" data-id=\"fusion_syntax_highlighter_10\" style=\"font-size:14px;\">Copy to Clipboard</span></div><label for=\"fusion_syntax_highlighter_10\" class=\"screen-reader-text\">Syntax Highlighter</label><textarea class=\"fusion-syntax-highlighter-textarea\" id=\"fusion_syntax_highlighter_10\" data-readOnly=\"nocursor\" data-lineNumbers=\"1\" data-lineWrapping=\"\" data-theme=\"default\" data-mode=\"text/x-sh\">@override\n  Widget build(BuildContext context) {\n    return PopScope(\n      canPop: false,\n      onPopInvoked: (didPop) async {\n        bool canPop = await _onWillPop(context);\n        if (canPop) {\n          Navigator.pop(context);\n        } else {\n          return;\n        }\n      },\n      child: Scaffold(\n        appBar: AppBar(\n          title: Text('Second Page'),\n        ),\n        body: Center(\n          child: ElevatedButton(\n            onPressed: () {\n              _onWillPop(context).then((exitConfirmed) {\n                if (exitConfirmed) {\n                  // Navigate back to the first page (HomePage) if exit is confirmed\n                  Navigator.pop(context);\n                }\n              });\n            },\n            child: Text('Back to First Page'),\n          ),\n        ),\n      ),\n    );\n  }\n}</textarea></div><div class=\"fusion-text fusion-text-35\" style=\"--awb-margin-top:20px;\"><p><span style=\"font-weight: 400;\">We only changed </span><span style=\"font-weight: 400;\">WillPopScope</span><span style=\"font-weight: 400;\"> to </span><span style=\"font-weight: 400;\">PopScope</span><span style=\"font-weight: 400;\"> and set </span><span style=\"font-weight: 400;\">canPop</span><span style=\"font-weight: 400;\"> to </span><span style=\"font-weight: 400;\">false</span><span style=\"font-weight: 400;\">, and the </span><span style=\"font-weight: 400;\">onPopInvoked</span><span style=\"font-weight: 400;\"> function worked perfectly.</span></p>\n</div><div class=\"fusion-title title fusion-title-18 fusion-sep-none fusion-title-text fusion-title-size-two\" style=\"--awb-text-color:#202020;--awb-font-size:35px;\"><h2 class=\"fusion-title-heading title-heading-left fusion-responsive-typography-calculated\" style=\"font-family:&quot;Plus Jakarta Sans&quot;;font-style:normal;font-weight:300;margin:0;font-size:1em;letter-spacing:-0.015em;text-transform:var(--awb-typography1-text-transform);--fontSize:35;line-height:1.5;text-shadow:0px;\"><span style=\"font-weight: 400;\">Wrap-up</span></h2></div><div class=\"fusion-text fusion-text-36\"><p><span style=\"font-weight: 400;\">In this blog, we explored the transition from </span><span style=\"font-weight: 400;\">WillPopScope</span><span style=\"font-weight: 400;\"> to </span><span style=\"font-weight: 400;\">PopScope</span><span style=\"font-weight: 400;\">, delving into its key features, technology stack, and coding intricacies. This insightful piece is brought to you by Deligence Technologies, a leader in innovative software solutions.</span></p>\n<p><span style=\"font-weight: 400;\">Deligence Technologies is a software development company that creates high-quality mobile applications. We use the latest technologies and our industry knowledge to design and build exceptional apps. </span></p>\n<p><span style=\"font-weight: 400;\">We specialize in flutter app development, if you want to learn about our flutter services, visit: </span><strong><a href=\"https://www.deligence.com/technology/flutter-services/\">Flutter Services</a></strong></p>\n</div></div></div></div></div>\n","date":"2024-04-19T12:10:35","author":{"node":{"name":"Sanjay Kumar","avatar":{"url":"https://secure.gravatar.com/avatar/12cd5109e81ca7f47c3bdfd017c1351234efe746c16d7811a74e031e6887c0e7?s=96&d=mm&r=g"}}},"featuredImage":{"node":{"altText":"","gatsbyImageData":null}}}},"pageContext":{"id":"cG9zdDoxNzcxOA=="}},"staticQueryHashes":[],"slicesMap":{"footer":"footer","header":"header"}}